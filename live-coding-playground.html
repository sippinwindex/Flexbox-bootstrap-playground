<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Live coding playground for HTML, CSS, and Bootstrap">
    <title>Live Coding Playground - HTML + CSS + Bootstrap</title>
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- CodeMirror for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #28a745, #20c997);
            --warning-gradient: linear-gradient(135deg, #ffc107, #ff8c00);
            --info-gradient: linear-gradient(135deg, #17a2b8, #20c997);
            --danger-gradient: linear-gradient(135deg, #dc3545, #c82333);
            --dark-gradient: linear-gradient(135deg, #343a40, #495057);
            --bg-light: #f8f9fa;
            --border-color: #dee2e6;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 15px rgba(0,0,0,0.15);
            --transition-base: 0.3s ease-out;
        }

        * {
            box-sizing: border-box;
        }

        body {
            background: var(--bg-light);
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Fullscreen styles */
        .fullscreen-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--bg-light);
            z-index: 9999;
            display: none;
        }

        .fullscreen-container.active {
            display: flex;
            flex-direction: column;
        }

        .fullscreen-header {
            background: var(--primary-gradient);
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .fullscreen-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Main container styles */
        .main-container {
            height: calc(100vh - 140px);
            display: flex;
            gap: 1rem;
            padding: 1rem;
            min-height: 600px;
        }

        .main-container.fullscreen {
            height: 100%;
            padding: 0;
            gap: 0;
        }

        .editor-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            min-width: 300px;
        }

        .fullscreen .editor-section {
            border-radius: 0;
            box-shadow: none;
        }

        .preview-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            min-width: 300px;
        }

        .fullscreen .preview-section {
            border-radius: 0;
            box-shadow: none;
        }

        .editor-tabs {
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding: 0;
            margin: 0;
            flex-shrink: 0;
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 12px 20px;
            font-weight: 600;
            font-size: 0.9rem;
            color: #6c757d;
            cursor: pointer;
            transition: all var(--transition-base);
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn.active {
            color: #495057;
            background: white;
            border-bottom-color: #667eea;
        }

        .tab-btn:hover:not(.active) {
            background: #e9ecef;
            color: #495057;
        }

        .editor-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .editor-panel {
            flex: 1;
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .editor-panel.active {
            display: flex;
        }

        .CodeMirror {
            height: 100% !important;
            font-size: 14px;
            line-height: 1.5;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .preview-header {
            background: var(--success-gradient);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .preview-frame {
            flex: 1;
            border: none;
            background: white;
            width: 100%;
        }

        .live-indicator {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .toolbar {
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            flex-shrink: 0;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar-btn {
            background: #f8f9fa;
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .toolbar-btn:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }

        .toolbar-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .fullscreen-btn {
            background: var(--info-gradient) !important;
            color: white !important;
            border-color: transparent !important;
        }

        .fullscreen-btn:hover {
            background: var(--primary-gradient) !important;
        }

        .theme-selector {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.8rem;
            background: white;
        }

        .status-bar {
            background: #f8f9fa;
            border-top: 1px solid var(--border-color);
            padding: 8px 16px;
            font-size: 0.8rem;
            color: #6c757d;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .error-indicator {
            color: #dc3545;
            display: none;
        }

        .error-indicator.show {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .preset-dropdown {
            position: relative;
        }

        .preset-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: var(--shadow-md);
            min-width: 250px;
            z-index: 1000;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }

        .preset-menu.show {
            display: block;
        }

        .preset-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f8f9fa;
            transition: background 0.2s;
        }

        .preset-item:hover {
            background: #f8f9fa;
        }

        .preset-item:last-child {
            border-bottom: none;
        }

        .preset-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 4px;
        }

        .preset-description {
            font-size: 0.8rem;
            color: #6c757d;
        }

        .responsive-controls {
            display: flex;
            gap: 4px;
        }

        .responsive-btn {
            background: #f8f9fa;
            border: 1px solid var(--border-color);
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.7rem;
        }

        .responsive-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .console-panel {
            background: #1a1a1a;
            color: #e6e6e6;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 12px;
            padding: 12px;
            max-height: 200px;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
            display: none;
            flex-shrink: 0;
        }

        .console-panel.show {
            display: block;
        }

        .console-filters {
            display: flex;
            gap: 4px;
        }

        .filter-btn {
            background: #333;
            color: #ccc;
            border: 1px solid #555;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .console-log {
            margin: 4px 0;
            padding: 2px 0;
            border-left: 3px solid transparent;
            padding-left: 8px;
        }

        .console-error {
            color: #ff6b6b;
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .console-warn {
            color: #feca57;
            border-left-color: #feca57;
            background: rgba(254, 202, 87, 0.1);
        }

        .console-info {
            color: #48cae4;
            border-left-color: #48cae4;
            background: rgba(72, 202, 228, 0.1);
        }

        .console-log.console-log {
            color: #e6e6e6;
            border-left-color: #666;
        }

        .console-time {
            color: #888;
            font-size: 10px;
        }

        .resize-handle {
            width: 4px;
            background: var(--border-color);
            cursor: col-resize;
            transition: background 0.2s;
            position: relative;
            flex-shrink: 0;
        }

        .resize-handle:hover {
            background: #667eea;
        }

        .fullscreen .resize-handle {
            display: block;
        }

        .exit-fullscreen {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .exit-fullscreen:hover {
            background: rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                height: auto;
                min-height: auto;
            }
            
            .editor-section,
            .preview-section {
                flex: none;
                min-height: 400px;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }
            
            .toolbar-group {
                justify-content: center;
                flex-wrap: wrap;
            }

            .resize-handle {
                display: none;
            }

            .fullscreen-content {
                flex-direction: column;
            }

            .fullscreen .editor-section,
            .fullscreen .preview-section {
                flex: 1;
            }
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }

        .loading-overlay.show {
            display: flex;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Improved focus styles */
        .toolbar-btn:focus,
        .tab-btn:focus,
        .responsive-btn:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }
    </style>
</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top" id="main-nav">
    <div class="container-fluid">
        <a class="navbar-brand" href="#" onclick="showToast('Welcome to Live Coding Playground!', 'info')">
            <i class="bi bi-code-square me-2"></i>Live Coding Playground
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="#" onclick="loadPreset('basic-page')">
                    <i class="bi bi-house me-1"></i>Home
                </a>
                <a class="nav-link" href="#" onclick="loadPreset('flexbox-demo')">
                    <i class="bi bi-grid-3x3 me-1"></i>Flexbox
                </a>
                <a class="nav-link" href="#" onclick="switchTab('html')">
                    <i class="bi bi-code me-1"></i>HTML
                </a>
                <a class="nav-link" href="#" onclick="switchTab('bootstrap')">
                    <i class="bi bi-bootstrap me-1"></i>Bootstrap
                </a>
                <a class="nav-link active" href="#" onclick="showToast('You are here!', 'info')">
                    <i class="bi bi-play-circle me-1"></i>Live Coding
                </a>
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-grid-3x3-gap me-1"></i>Templates
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('landing-page')">
                            <i class="bi bi-layout-text-window me-2"></i>Landing Page
                        </a></li>
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('card-layout')">
                            <i class="bi bi-card-list me-2"></i>Card Layout
                        </a></li>
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('form-design')">
                            <i class="bi bi-ui-checks me-2"></i>Form Design
                        </a></li>
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('navigation')">
                            <i class="bi bi-menu-button-wide me-2"></i>Navigation
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('animation-demo')">
                            <i class="bi bi-stars me-2"></i>Animations
                        </a></li>
                        <li><a class="dropdown-item" href="#" onclick="loadPreset('grid-system')">
                            <i class="bi bi-grid me-2"></i>Grid System
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section class="bg-gradient text-white py-3" style="background: var(--primary-gradient);" id="hero-section">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="h4 fw-bold mb-2">
                    <i class="bi bi-play-circle me-2"></i>Live Coding Playground
                </h1>
                <p class="mb-0 small">Write HTML, CSS, and Bootstrap code and see instant results. Perfect for learning and experimentation!</p>
            </div>
            <div class="col-lg-4 text-end">
                <div class="d-flex justify-content-end gap-2">
                    <span class="badge bg-light text-dark small"><i class="bi bi-lightning me-1"></i>Real-time</span>
                    <span class="badge bg-light text-dark small"><i class="bi bi-bootstrap me-1"></i>Bootstrap 5</span>
                    <span class="badge bg-light text-dark small"><i class="bi bi-palette me-1"></i>Syntax Highlighting</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Fullscreen Container -->
<div class="fullscreen-container" id="fullscreen-container">
    <div class="fullscreen-header">
        <div>
            <h5 class="mb-0">
                <i class="bi bi-arrows-fullscreen me-2"></i>Fullscreen Coding Mode
            </h5>
        </div>
        <button class="exit-fullscreen" onclick="exitFullscreen()">
            <i class="bi bi-fullscreen-exit"></i>
            Exit Fullscreen
        </button>
    </div>
    <div class="fullscreen-content" id="fullscreen-content">
        <!-- Content will be moved here when fullscreen -->
    </div>
</div>

<!-- Main Content -->
<div class="main-container" id="main-container">
    <!-- Editor Section -->
    <div class="editor-section" id="editor-section">
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="toolbar-group">
                <div class="preset-dropdown">
                    <button class="toolbar-btn" onclick="togglePresets()">
                        <i class="bi bi-collection"></i>Templates
                    </button>
                    <div class="preset-menu" id="preset-menu">
                        <div class="preset-item" onclick="loadPreset('basic-page')">
                            <div class="preset-title">Basic Page</div>
                            <div class="preset-description">Simple HTML structure with Bootstrap</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('landing-page')">
                            <div class="preset-title">Landing Page</div>
                            <div class="preset-description">Hero section with call-to-action</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('card-layout')">
                            <div class="preset-title">Card Layout</div>
                            <div class="preset-description">Bootstrap cards with custom CSS</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('form-design')">
                            <div class="preset-title">Form Design</div>
                            <div class="preset-description">Styled contact form</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('navigation')">
                            <div class="preset-title">Navigation Bar</div>
                            <div class="preset-description">Responsive navbar with dropdown</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('flexbox-demo')">
                            <div class="preset-title">Flexbox Demo</div>
                            <div class="preset-description">CSS Flexbox with Bootstrap utilities</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('grid-system')">
                            <div class="preset-title">Grid System</div>
                            <div class="preset-description">Bootstrap grid with custom styling</div>
                        </div>
                        <div class="preset-item" onclick="loadPreset('animation-demo')">
                            <div class="preset-title">CSS Animations</div>
                            <div class="preset-description">CSS transitions and animations</div>
                        </div>
                    </div>
                </div>
                
                <button class="toolbar-btn" onclick="runCode()">
                    <i class="bi bi-play-fill"></i>Run
                </button>
                
                <button class="toolbar-btn" onclick="clearCode()">
                    <i class="bi bi-trash"></i>Clear
                </button>
                
                <button class="toolbar-btn" onclick="formatCode()">
                    <i class="bi bi-code"></i>Format
                </button>

                <button class="toolbar-btn fullscreen-btn" onclick="enterFullscreen()">
                    <i class="bi bi-arrows-fullscreen"></i>Fullscreen
                </button>
            </div>
            
            <div class="toolbar-group">
                <select class="theme-selector" id="theme-selector" onchange="changeTheme()">
                    <option value="github">Light Theme</option>
                    <option value="monokai" selected>Dark Theme</option>
                    <option value="dracula">Dracula</option>
                </select>
                
                <button class="toolbar-btn" onclick="toggleConsole()">
                    <i class="bi bi-terminal"></i>Console
                </button>
                
                <button class="toolbar-btn" onclick="showShortcuts()">
                    <i class="bi bi-question-circle"></i>Help
                </button>
            </div>
        </div>

        <!-- Editor Tabs -->
        <div class="editor-tabs">
            <button class="tab-btn active" onclick="switchTab('html')" id="html-tab">
                <i class="bi bi-code-slash"></i>HTML
            </button>
            <button class="tab-btn" onclick="switchTab('css')" id="css-tab">
                <i class="bi bi-palette"></i>CSS
            </button>
            <button class="tab-btn" onclick="switchTab('bootstrap')" id="bootstrap-tab">
                <i class="bi bi-bootstrap"></i>Bootstrap Classes
            </button>
        </div>

        <!-- Editor Container -->
        <div class="editor-container">
            <!-- HTML Editor -->
            <div class="editor-panel active" id="html-panel">
                <textarea id="html-editor" placeholder="Write your HTML here...">
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">Welcome to Live Coding!</h3>
                </div>
                <div class="card-body">
                    <p class="lead">Start editing the HTML, CSS, or Bootstrap classes to see live changes.</p>
                    <button class="btn btn-success btn-lg">Get Started</button>
                </div>
            </div>
        </div>
    </div>
</div></textarea>
            </div>

            <!-- CSS Editor -->
            <div class="editor-panel" id="css-panel">
                <textarea id="css-editor" placeholder="Write your CSS here...">
/* Custom CSS Styles */
.card {
    border: none;
    border-radius: 15px;
    transition: transform 0.3s ease;
}

.card:hover {
    transform: translateY(-5px);
}

.card-header {
    border-radius: 15px 15px 0 0 !important;
}

.btn-success {
    background: linear-gradient(45deg, #28a745, #20c997);
    border: none;
    border-radius: 25px;
    padding: 12px 30px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.3s ease;
}

.btn-success:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
}

body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}</textarea>
            </div>

            <!-- Bootstrap Classes Helper -->
            <div class="editor-panel" id="bootstrap-panel">
                <textarea id="bootstrap-editor" placeholder="Bootstrap classes and utilities reference...">
<!-- Bootstrap 5 Quick Reference -->

<!-- Layout Classes -->
.container, .container-fluid
.row, .col, .col-md-6, .col-lg-4

<!-- Spacing Utilities -->
.m-0 to .m-5 (margin)
.p-0 to .p-5 (padding)
.mt-3, .mb-4, .ms-2, .me-1 (directional)

<!-- Flexbox Utilities -->
.d-flex, .justify-content-center, .align-items-center
.flex-column, .flex-row, .flex-wrap

<!-- Text Utilities -->
.text-center, .text-start, .text-end
.text-primary, .text-success, .text-danger
.fw-bold, .fw-normal, .fs-1 to .fs-6

<!-- Background Colors -->
.bg-primary, .bg-success, .bg-warning
.bg-light, .bg-dark, .bg-transparent

<!-- Components -->
.btn .btn-primary .btn-lg .btn-outline-success
.card .card-header .card-body .card-footer
.navbar .nav-link .dropdown-menu
.alert .alert-info .alert-dismissible

<!-- Responsive Display -->
.d-none .d-md-block .d-lg-inline
.d-sm-flex .d-xl-none

<!-- Position Utilities -->
.position-relative .position-absolute
.top-0 .bottom-0 .start-0 .end-0

<!-- Border Utilities -->
.border .border-0 .rounded .rounded-circle
.border-primary .border-2

<!-- Shadow Utilities -->
.shadow-sm .shadow .shadow-lg

Copy and paste these classes into your HTML to see them in action!</textarea>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div>
                <span id="cursor-position">Ln 1, Col 1</span>
                <span class="ms-3" id="word-count">0 words</span>
            </div>
            <div class="error-indicator" id="error-indicator">
                <i class="bi bi-exclamation-triangle"></i>
                <span id="error-message">No errors</span>
            </div>
            <div>
                <span id="auto-save-status">Auto-save: On</span>
            </div>
        </div>

        <!-- Enhanced Console Panel -->
        <div class="console-panel" id="console-panel">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="d-flex align-items-center gap-3">
                    <strong>Console Output</strong>
                    <div class="console-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterConsole('all')">All</button>
                        <button class="filter-btn" data-filter="log" onclick="filterConsole('log')">Logs</button>
                        <button class="filter-btn" data-filter="error" onclick="filterConsole('error')">Errors</button>
                        <button class="filter-btn" data-filter="warn" onclick="filterConsole('warn')">Warnings</button>
                    </div>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-light" onclick="testConsole()">Test</button>
                    <button class="btn btn-sm btn-outline-light" onclick="clearConsole()">Clear</button>
                </div>
            </div>
            <div id="console-output">
                <div class="console-log console-info">
                    [${new Date().toLocaleTimeString()}] Console ready - Try adding JavaScript to your HTML!
                </div>
            </div>
        </div>
    </div>

    <!-- Resize Handle -->
    <div class="resize-handle" id="resize-handle"></div>

    <!-- Preview Section -->
    <div class="preview-section" id="preview-section">
        <div class="preview-header">
            <div>
                <h6 class="mb-0">
                    <i class="bi bi-eye me-2"></i>Live Preview
                </h6>
            </div>
            <div class="d-flex align-items-center gap-3">
                <div class="responsive-controls">
                    <button class="responsive-btn active" onclick="setPreviewSize('100%')" title="Desktop">
                        <i class="bi bi-display"></i>
                    </button>
                    <button class="responsive-btn" onclick="setPreviewSize('768px')" title="Tablet">
                        <i class="bi bi-tablet"></i>
                    </button>
                    <button class="responsive-btn" onclick="setPreviewSize('375px')" title="Mobile">
                        <i class="bi bi-phone"></i>
                    </button>
                </div>
                <div class="live-indicator">LIVE</div>
            </div>
        </div>
        
        <div style="flex: 1; position: relative;">
            <div class="loading-overlay" id="loading-overlay">
                <div class="spinner"></div>
            </div>
            <iframe id="preview-frame" class="preview-frame"></iframe>
        </div>
    </div>
</div>

<!-- Keyboard Shortcuts Modal -->
<div class="modal fade" id="shortcutsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-keyboard me-2"></i>Keyboard Shortcuts
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-6">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Run Code</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + Enter</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Format Code</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + Shift + F</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Save</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + S</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Find</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + F</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Replace</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + H</kbd>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Switch to HTML</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Alt + 1</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Switch to CSS</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Alt + 2</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Switch to Bootstrap</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Alt + 3</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Toggle Console</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">Ctrl + `</kbd>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Fullscreen</span>
                            <kbd class="bg-light text-dark px-2 py-1 rounded">F11</kbd>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container position-fixed top-0 end-0 p-3">
    <div id="main-toast" class="toast" role="alert">
        <div class="toast-header">
            <i class="bi bi-check-circle text-success me-2"></i>
            <strong class="me-auto" id="toast-title">Success</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body" id="toast-message">
            Code executed successfully!
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- CodeMirror Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closetag.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/selection/active-line.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/search.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/searchcursor.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.css"></script>

<!-- Main Application Script -->
<script>
    // Global variables
    let htmlEditor, cssEditor, bootstrapEditor;
    let currentTab = 'html';
    let autoSaveInterval;
    let updateTimeout;
    let isFullscreen = false;

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        try {
            initializeEditors();
            setupEventListeners();
            loadFromLocalStorage();
            updatePreview();
            startAutoSave();
        } catch (error) {
            console.error('Initialization error:', error);
            showToast('Initialization failed: ' + error.message, 'error');
        }
    });

    function initializeEditors() {
        // HTML Editor
        htmlEditor = CodeMirror.fromTextArea(document.getElementById('html-editor'), {
            mode: 'htmlmixed',
            theme: 'monokai',
            lineNumbers: true,
            autoCloseTags: true,
            autoCloseBrackets: true,
            matchBrackets: true,
            styleActiveLine: true,
            indentUnit: 2,
            tabSize: 2,
            lineWrapping: true,
            extraKeys: {
                "Ctrl-Enter": runCode,
                "Ctrl-S": saveCode,
                "Ctrl-Shift-F": formatCode,
                "Alt-1": () => switchTab('html'),
                "Alt-2": () => switchTab('css'),
                "Alt-3": () => switchTab('bootstrap'),
                "Ctrl-`": toggleConsole,
                "F11": toggleFullscreen
            }
        });

        // CSS Editor
        cssEditor = CodeMirror.fromTextArea(document.getElementById('css-editor'), {
            mode: 'css',
            theme: 'monokai',
            lineNumbers: true,
            autoCloseBrackets: true,
            matchBrackets: true,
            styleActiveLine: true,
            indentUnit: 2,
            tabSize: 2,
            lineWrapping: true,
            extraKeys: {
                "Ctrl-Enter": runCode,
                "Ctrl-S": saveCode,
                "Ctrl-Shift-F": formatCode,
                "Alt-1": () => switchTab('html'),
                "Alt-2": () => switchTab('css'),
                "Alt-3": () => switchTab('bootstrap'),
                "Ctrl-`": toggleConsole,
                "F11": toggleFullscreen
            }
        });

        // Bootstrap Editor
        bootstrapEditor = CodeMirror.fromTextArea(document.getElementById('bootstrap-editor'), {
            mode: 'htmlmixed',
            theme: 'monokai',
            lineNumbers: true,
            readOnly: false,
            styleActiveLine: true,
            lineWrapping: true,
            extraKeys: {
                "Ctrl-Enter": runCode,
                "Alt-1": () => switchTab('html'),
                "Alt-2": () => switchTab('css'),
                "Alt-3": () => switchTab('bootstrap'),
                "F11": toggleFullscreen
            }
        });

        // Set up change listeners
        htmlEditor.on('change', debounceUpdate);
        cssEditor.on('change', debounceUpdate);
        
        // Cursor position tracking
        htmlEditor.on('cursorActivity', updateCursorPosition);
        cssEditor.on('cursorActivity', updateCursorPosition);
    }

    function debounceUpdate() {
        clearTimeout(updateTimeout);
        updateTimeout = setTimeout(() => {
            updatePreview();
            updateWordCount();
        }, 300);
    }

    function setupEventListeners() {
        // Resize handle
        setupResizeHandle();
        
        // Keyboard shortcuts
        document.addEventListener('keydown', handleKeyboardShortcuts);
        
        // Close preset menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.preset-dropdown')) {
                document.getElementById('preset-menu').classList.remove('show');
            }
        });

        // Auto-save on beforeunload
        window.addEventListener('beforeunload', saveToLocalStorage);

        // Fullscreen API events
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        document.addEventListener('mozfullscreenchange', handleFullscreenChange);
        document.addEventListener('MSFullscreenChange', handleFullscreenChange);
    }

    function setupResizeHandle() {
        const resizeHandle = document.getElementById('resize-handle');
        const mainContainer = document.querySelector('.main-container');
        let isResizing = false;

        resizeHandle.addEventListener('mousedown', function(e) {
            isResizing = true;
            document.addEventListener('mousemove', handleResize);
            document.addEventListener('mouseup', stopResize);
            e.preventDefault();
        });

        function handleResize(e) {
            if (!isResizing) return;
            
            const containerRect = mainContainer.getBoundingClientRect();
            const percentage = ((e.clientX - containerRect.left) / containerRect.width) * 100;
            
            if (percentage > 20 && percentage < 80) {
                const editorSection = document.querySelector('.editor-section');
                const previewSection = document.querySelector('.preview-section');
                
                editorSection.style.flex = `0 0 ${percentage}%`;
                previewSection.style.flex = `0 0 ${100 - percentage}%`;
                
                // Refresh editors after resize
                setTimeout(() => {
                    htmlEditor.refresh();
                    cssEditor.refresh();
                    bootstrapEditor.refresh();
                }, 100);
            }
        }

        function stopResize() {
            isResizing = false;
            document.removeEventListener('mousemove', handleResize);
            document.removeEventListener('mouseup', stopResize);
        }
    }

    function handleKeyboardShortcuts(e) {
        // F11 for fullscreen toggle
        if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
        
        // Ctrl+Enter for run
        if (e.ctrlKey && e.key === 'Enter') {
            e.preventDefault();
            runCode();
        }
        
        // Ctrl+Shift+F for format
        if (e.ctrlKey && e.shiftKey && e.key === 'F') {
            e.preventDefault();
            formatCode();
        }
        
        // Ctrl+S for save
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            saveCode();
        }
    }

    // Fullscreen functionality
    function enterFullscreen() {
        const container = document.getElementById('fullscreen-container');
        const content = document.getElementById('fullscreen-content');
        const mainContainer = document.getElementById('main-container');
        
        // Move content to fullscreen container
        content.appendChild(mainContainer);
        
        // Show fullscreen container
        container.classList.add('active');
        mainContainer.classList.add('fullscreen');
        
        // Hide main nav and hero
        document.getElementById('main-nav').style.display = 'none';
        document.getElementById('hero-section').style.display = 'none';
        
        isFullscreen = true;
        
        // Refresh editors
        setTimeout(() => {
            htmlEditor.refresh();
            cssEditor.refresh();
            bootstrapEditor.refresh();
        }, 100);
        
        showToast('Entered fullscreen mode', 'info');
    }

    function exitFullscreen() {
        const container = document.getElementById('fullscreen-container');
        const mainContainer = document.getElementById('main-container');
        const originalParent = document.body;
        
        // Move content back to original position
        originalParent.appendChild(mainContainer);
        
        // Hide fullscreen container
        container.classList.remove('active');
        mainContainer.classList.remove('fullscreen');
        
        // Show main nav and hero
        document.getElementById('main-nav').style.display = 'block';
        document.getElementById('hero-section').style.display = 'block';
        
        // Reset flex styles
        document.querySelector('.editor-section').style.flex = '';
        document.querySelector('.preview-section').style.flex = '';
        
        isFullscreen = false;
        
        // Refresh editors
        setTimeout(() => {
            htmlEditor.refresh();
            cssEditor.refresh();
            bootstrapEditor.refresh();
        }, 100);
        
        showToast('Exited fullscreen mode', 'info');
    }

    function toggleFullscreen() {
        if (isFullscreen) {
            exitFullscreen();
        } else {
            enterFullscreen();
        }
    }

    function handleFullscreenChange() {
        // Handle browser fullscreen API
        const isInFullscreen = document.fullscreenElement || 
                              document.webkitFullscreenElement || 
                              document.mozFullScreenElement || 
                              document.msFullscreenElement;
        
        if (!isInFullscreen && isFullscreen) {
            // Browser exited fullscreen, but we're still in app fullscreen
            // User might have pressed ESC, so we should exit our fullscreen too
            exitFullscreen();
        }
    }

    // Tab switching
    function switchTab(tab) {
        try {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            
            // Update editor panels
            document.querySelectorAll('.editor-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(`${tab}-panel`).classList.add('active');
            
            currentTab = tab;
            
            // Refresh the active editor
            setTimeout(() => {
                if (tab === 'html') htmlEditor.refresh();
                else if (tab === 'css') cssEditor.refresh();
                else if (tab === 'bootstrap') bootstrapEditor.refresh();
            }, 100);
            
        } catch (error) {
            console.error('Tab switching error:', error);
            showToast('Failed to switch tab', 'error');
        }
    }

    // Update preview
    function updatePreview() {
        try {
            const htmlContent = htmlEditor.getValue();
            const cssContent = cssEditor.getValue();
            
            const fullHTML = generateFullHTML(htmlContent, cssContent);
            
            const iframe = document.getElementById('preview-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            iframeDoc.open();
            iframeDoc.write(fullHTML);
            iframeDoc.close();
            
            // Clear any previous errors
            hideError();
            
        } catch (error) {
            showError('Preview Error: ' + error.message);
            console.error('Preview update error:', error);
        }
    }

    function generateFullHTML(htmlContent, cssContent) {
        return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Preview</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        /* Reset and base styles */
        * { box-sizing: border-box; }
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        
        /* User CSS */
        ${cssContent}
    </style>
</head>
<body>
    ${htmlContent}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"><\/script>
    <script>
        // Enhanced console capture
        const originalConsole = { ...console };
        
        function sendToParent(type, method, args) {
            try {
                parent.postMessage({
                    type: type,
                    method: method,
                    args: args,
                    timestamp: new Date().toISOString()
                }, '*');
            } catch (e) {
                // Ignore cross-origin errors
            }
        }
        
        // Capture all console methods
        ['log', 'error', 'warn', 'info', 'debug', 'table', 'group', 'groupEnd'].forEach(method => {
            console[method] = function(...args) {
                originalConsole[method](...args);
                
                const formattedArgs = args.map(arg => {
                    if (typeof arg === 'object') {
                        try {
                            return JSON.stringify(arg, null, 2);
                        } catch (e) {
                            return '[Object object]';
                        }
                    }
                    return String(arg);
                });
                
                sendToParent('console', method === 'debug' ? 'log' : method, formattedArgs);
            };
        });
        
        // Capture errors
        window.addEventListener('error', function(e) {
            sendToParent('error', 'error', [
                \`\${e.message} at \${e.filename}:\${e.lineno}:\${e.colno}\`
            ]);
        });
        
        // Capture unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            sendToParent('error', 'error', [
                'Unhandled Promise Rejection: ' + e.reason
            ]);
        });
        
        // Performance monitoring
        window.addEventListener('load', function() {
            const loadTime = performance.now();
            if (loadTime > 100) {
                sendToParent('console', 'warn', [
                    \`Page load time: \${loadTime.toFixed(2)}ms\`
                ]);
            }
        });
        
        // Add helper functions for testing
        window.testConsole = function() {
            console.log('Test log from preview');
            console.warn('Test warning from preview');
            console.error('Test error from preview');
            console.info('Test info from preview');
        };
    <\/script>
</body>
</html>`;
    }

    // Enhanced message handling from iframe
    window.addEventListener('message', function(e) {
        if (e.data.type === 'console') {
            addConsoleMessage(e.data.method, e.data.args.join(' '));
        } else if (e.data.type === 'error') {
            addConsoleMessage('error', e.data.args ? e.data.args[0] : `${e.data.message} at line ${e.data.lineno}`);
            showError(`Runtime Error: ${e.data.message || e.data.args[0]}`);
        }
    });

    // Enhanced console functionality
    let consoleFilter = 'all';
    let consoleMessages = [];

    function addConsoleMessage(type, message) {
        const timestamp = new Date().toLocaleTimeString();
        const messageObj = { type, message, timestamp };
        consoleMessages.push(messageObj);
        
        // Limit to last 100 messages
        if (consoleMessages.length > 100) {
            consoleMessages.shift();
        }
        
        updateConsoleDisplay();
    }

    function updateConsoleDisplay() {
        const consoleOutput = document.getElementById('console-output');
        if (!consoleOutput) return;
        
        // Filter messages based on current filter
        const filteredMessages = consoleMessages.filter(msg => 
            consoleFilter === 'all' || msg.type === consoleFilter
        );
        
        // Clear and rebuild console
        consoleOutput.innerHTML = '';
        
        filteredMessages.forEach(msg => {
            const logEntry = document.createElement('div');
            logEntry.className = `console-log console-${msg.type}`;
            logEntry.innerHTML = `<span class="console-time">[${msg.timestamp}]</span> ${msg.message}`;
            consoleOutput.appendChild(logEntry);
        });
        
        consoleOutput.scrollTop = consoleOutput.scrollHeight;
    }

    function filterConsole(filter) {
        consoleFilter = filter;
        
        // Update filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.filter === filter);
        });
        
        updateConsoleDisplay();
    }

    function testConsole() {
        // Add test messages to demonstrate console functionality
        addConsoleMessage('log', 'This is a test log message');
        addConsoleMessage('info', 'Bootstrap and JavaScript are loaded successfully');
        addConsoleMessage('warn', 'This is a warning message example');
        addConsoleMessage('error', 'This is an error message example');
        
        showToast('Console test messages added!', 'info');
    }

    function clearConsole() {
        consoleMessages = [];
        document.getElementById('console-output').innerHTML = '';
        addConsoleMessage('info', 'Console cleared');
        showToast('Console cleared!', 'info');
    }

    // Toolbar functions
    function runCode() {
        try {
            showLoading();
            setTimeout(() => {
                updatePreview();
                hideLoading();
                showToast('Code executed successfully!', 'success');
            }, 200);
        } catch (error) {
            hideLoading();
            console.error('Run code error:', error);
            showToast('Failed to run code', 'error');
        }
    }

    function clearCode() {
        if (confirm('Are you sure you want to clear all code? This action cannot be undone.')) {
            htmlEditor.setValue('');
            cssEditor.setValue('');
            clearConsole();
            updatePreview();
            showToast('Code cleared!', 'info');
        }
    }

    function formatCode() {
        try {
            const currentEditor = getCurrentEditor();
            if (!currentEditor) return;
            
            const code = currentEditor.getValue();
            let formatted = code;
            
            if (currentTab === 'html') {
                formatted = formatHTML(code);
            } else if (currentTab === 'css') {
                formatted = formatCSS(code);
            }
            
            currentEditor.setValue(formatted);
            showToast('Code formatted!', 'success');
            
        } catch (error) {
            console.error('Format code error:', error);
            showToast('Failed to format code', 'error');
        }
    }

    function formatHTML(html) {
        // Simple HTML formatting
        return html
            .replace(/></g, '>\n<')
            .replace(/^\s+|\s+$/g, '')
            .split('\n')
            .map((line, index, arr) => {
                const trimmed = line.trim();
                if (!trimmed) return '';
                
                let indent = 0;
                for (let i = 0; i < index; i++) {
                    const prevLine = arr[i].trim();
                    if (prevLine) {
                        const prevOpenTags = (prevLine.match(/<[^\/][^>]*>/g) || []).length;
                        const prevCloseTags = (prevLine.match(/<\/[^>]*>/g) || []).length;
                        const prevSelfClosing = (prevLine.match(/<[^>]*\/>/g) || []).length;
                        indent += (prevOpenTags - prevSelfClosing) - prevCloseTags;
                    }
                }
                
                if (trimmed.startsWith('</')) indent = Math.max(0, indent - 1);
                
                return '  '.repeat(Math.max(0, indent)) + trimmed;
            })
            .filter(line => line.trim())
            .join('\n');
    }

    function formatCSS(css) {
        // Simple CSS formatting
        return css
            .replace(/\{/g, ' {\n  ')
            .replace(/\}/g, '\n}\n')
            .replace(/;/g, ';\n  ')
            .replace(/,/g, ',\n')
            .replace(/\n\s*\n/g, '\n')
            .replace(/^\s+|\s+$/g, '');
    }

    function getCurrentEditor() {
        switch (currentTab) {
            case 'html': return htmlEditor;
            case 'css': return cssEditor;
            case 'bootstrap': return bootstrapEditor;
            default: return htmlEditor;
        }
    }

    function changeTheme() {
        const theme = document.getElementById('theme-selector').value;
        htmlEditor.setOption('theme', theme);
        cssEditor.setOption('theme', theme);
        bootstrapEditor.setOption('theme', theme);
        
        showToast(`Theme changed to ${theme}!`, 'info');
    }

    function toggleConsole() {
        const consolePanel = document.getElementById('console-panel');
        consolePanel.classList.toggle('show');
        
        if (consolePanel.classList.contains('show')) {
            showToast('Console opened', 'info');
        } else {
            showToast('Console closed', 'info');
        }
    }

    function clearConsole() {
        document.getElementById('console-output').innerHTML = '';
        showToast('Console cleared!', 'info');
    }

    function setPreviewSize(width) {
        const iframe = document.getElementById('preview-frame');
        iframe.style.width = width;
        iframe.style.margin = width === '100%' ? '0' : '0 auto';
        
        // Update active button
        document.querySelectorAll('.responsive-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        
        const deviceName = width === '100%' ? 'Desktop' : width === '768px' ? 'Tablet' : 'Mobile';
        showToast(`Preview size: ${deviceName}`, 'info');
    }

    // Preset templates
    function togglePresets() {
        document.getElementById('preset-menu').classList.toggle('show');
    }

    function loadPreset(presetName) {
        const presets = {
            'basic-page': {
                html: `<div class="container py-5">
    <div class="row">
        <div class="col-12 text-center">
            <h1 class="display-4 mb-4">Welcome to My Website</h1>
            <p class="lead">This is a basic Bootstrap page template.</p>
            <button class="btn btn-primary btn-lg">Get Started</button>
        </div>
    </div>
</div>`,
                css: `body {
    background-color: #f8f9fa;
}

.display-4 {
    color: #495057;
    font-weight: 300;
}

.btn-primary {
    background: linear-gradient(45deg, #007bff, #0056b3);
    border: none;
    border-radius: 25px;
    padding: 12px 30px;
}`
            },
            'flexbox-demo': {
                html: `<div class="container py-5">
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h2>CSS Flexbox + Bootstrap Demo</h2>
            <p class="lead">Combining CSS Flexbox with Bootstrap utilities</p>
        </div>
    </div>
    
    <!-- Flexbox Layout Examples -->
    <div class="row g-4">
        <div class="col-md-6">
            <div class="demo-card">
                <h4>Centered Content</h4>
                <div class="flex-demo flex-center">
                    <div class="flex-item">Item 1</div>
                    <div class="flex-item">Item 2</div>
                    <div class="flex-item">Item 3</div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="demo-card">
                <h4>Space Between</h4>
                <div class="flex-demo flex-between">
                    <div class="flex-item">Start</div>
                    <div class="flex-item">Middle</div>
                    <div class="flex-item">End</div>
                </div>
            </div>
        </div>
    </div>
</div>`,
                css: `body {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
}

.demo-card {
    background: white;
    padding: 1.5rem;
    border-radius: 15px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    height: 100%;
}

.demo-card h4 {
    color: #333;
    margin-bottom: 1rem;
    font-weight: 600;
}

.flex-demo {
    background: #f8f9fa;
    border: 2px dashed #dee2e6;
    border-radius: 10px;
    padding: 1rem;
    min-height: 120px;
}

.flex-center {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
}

.flex-between {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.flex-item {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-weight: 500;
    text-align: center;
    min-width: 80px;
}`
            }
        };

        const preset = presets[presetName];
        if (preset) {
            if (preset.html) htmlEditor.setValue(preset.html);
            if (preset.css) cssEditor.setValue(preset.css);
            
            updatePreview();
            showToast(`Loaded ${presetName.replace('-', ' ')} template!`, 'success');
        }
        
        togglePresets(); // Close menu
    }

    // Utility functions
    function updateCursorPosition() {
        const editor = getCurrentEditor();
        if (!editor) return;
        
        const cursor = editor.getCursor();
        document.getElementById('cursor-position').textContent = `Ln ${cursor.line + 1}, Col ${cursor.ch + 1}`;
    }

    function updateWordCount() {
        const htmlContent = htmlEditor.getValue();
        const cssContent = cssEditor.getValue();
        const totalContent = htmlContent + ' ' + cssContent;
        const wordCount = totalContent.trim().split(/\s+/).filter(word => word.length > 0).length;
        
        document.getElementById('word-count').textContent = `${wordCount} words`;
    }

    function showError(message) {
        const errorIndicator = document.getElementById('error-indicator');
        const errorMessage = document.getElementById('error-message');
        
        errorIndicator.classList.add('show');
        errorMessage.textContent = message;
    }

    function hideError() {
        document.getElementById('error-indicator').classList.remove('show');
    }

    function showLoading() {
        document.getElementById('loading-overlay').classList.add('show');
    }

    function hideLoading() {
        document.getElementById('loading-overlay').classList.remove('show');
    }

    // Auto-save functionality
    function startAutoSave() {
        autoSaveInterval = setInterval(() => {
            saveToLocalStorage();
        }, 30000); // Save every 30 seconds
    }

    function saveToLocalStorage() {
        try {
            const data = {
                html: htmlEditor.getValue(),
                css: cssEditor.getValue(),
                bootstrap: bootstrapEditor.getValue(),
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('liveCodingPlayground', JSON.stringify(data));
            document.getElementById('auto-save-status').textContent = 'Auto-save: ✓ Saved';
            
            setTimeout(() => {
                document.getElementById('auto-save-status').textContent = 'Auto-save: On';
            }, 2000);
            
        } catch (error) {
            console.error('Auto-save failed:', error);
            document.getElementById('auto-save-status').textContent = 'Auto-save: Failed';
        }
    }

    function loadFromLocalStorage() {
        try {
            const saved = localStorage.getItem('liveCodingPlayground');
            if (saved) {
                const data = JSON.parse(saved);
                
                if (data.html) htmlEditor.setValue(data.html);
                if (data.css) cssEditor.setValue(data.css);
                if (data.bootstrap) bootstrapEditor.setValue(data.bootstrap);
                
                showToast('Previous session restored!', 'info');
            }
        } catch (error) {
            console.error('Failed to load from localStorage:', error);
        }
    }

    function saveCode() {
        saveToLocalStorage();
        showToast('Code saved!', 'success');
    }

    function showShortcuts() {
        const modal = new bootstrap.Modal(document.getElementById('shortcutsModal'));
        modal.show();
    }

    // Toast notification system
    function showToast(message, type = 'success') {
        const toastEl = document.getElementById('main-toast');
        const titleEl = document.getElementById('toast-title');
        const messageEl = document.getElementById('toast-message');
        
        if (!toastEl || !titleEl || !messageEl) return;
        
        const toastHeader = toastEl.querySelector('.toast-header');
        const toastIcon = toastHeader.querySelector('i');
        
        const typeConfigs = {
            success: { icon: 'bi-check-circle', color: 'text-success', title: 'Success' },
            error: { icon: 'bi-x-circle', color: 'text-danger', title: 'Error' },
            warning: { icon: 'bi-exclamation-triangle', color: 'text-warning', title: 'Warning' },
            info: { icon: 'bi-info-circle', color: 'text-info', title: 'Info' }
        };
        
        const config = typeConfigs[type] || typeConfigs.success;
        
        toastIcon.className = `${config.icon} ${config.color} me-2`;
        titleEl.textContent = config.title;
        messageEl.textContent = message;
        
        const toast = new bootstrap.Toast(toastEl, {
            autohide: true,
            delay: type === 'error' ? 5000 : 3000
        });
        toast.show();
    }

    // Clean up on page unload
    window.addEventListener('beforeunload', function() {
        if (autoSaveInterval) {
            clearInterval(autoSaveInterval);
        }
        saveToLocalStorage();
    });

    // Performance monitoring
    if ('performance' in window) {
        window.addEventListener('load', function() {
            setTimeout(function() {
                const navigation = performance.getEntriesByType('navigation')[0];
                if (navigation && navigation.loadEventEnd > 3000) {
                    console.warn('Page load time:', navigation.loadEventEnd + 'ms');
                }
            }, 1000);
        });
    }